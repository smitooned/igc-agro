# Use this package to enable your node application to connect to the Phoenix Eureka server!


## Why this package exists

* To provide out of the box functionality to connect to the Phoenix Eureka server by providing just the service name, ip and port
* To have a common package who's implementation might change at a later date. All users of this package need only to worry about using this package in their projects and not worry about the underlying implementation (think abstraction for connecting to a eureka server)
* This project is still very nascent and does not implement all of the features provided by its current underlying implementation, [eureka-js-client](https://www.npmjs.com/package/eureka-js-client)
    - If you think that there is some common functionality that ought to be exposed, please raise a pull request!


## Projects which use this module
* [Configuration And Deployment](https://gitlab.ird.mu-sigma.com/phoenix/configuration-deployment)
* [Studio](https://gitlab.ird.mu-sigma.com/phoenix/studio)
* [Studio-Service](https://gitlab.ird.mu-sigma.com/phoenix/studio-service)
* [Phoenix Marketplace](https://gitlab.ird.mu-sigma.com/phoenix/marketplace)
* [Gitlab Bot](https://gitlab.ird.mu-sigma.com/phoenix/addons/gitlab-bot)
* [Phoenix Home](https://gitlab.ird.mu-sigma.com/phoenix/home)
* [Admin UI](https://gitlab.ird.mu-sigma.com/phoenix/admin)
* [EOC-REST](https://gitlab.ird.mu-sigma.com/phoenix/apps/eoc-rest)
* [Heimdall](https://gitlab.ird.mu-sigma.com/architecture/heimdall)


## Usage

1. The package is only available from the ird npm repository; set the registry path

    ```
    npm set registry https://ird.mu-sigma.com/npm/
    ```

2. The package is available inside the scope `@phoenix`; so configure to access the scope

    ```
    npm config set @phoenix:registry https://ird.mu-sigma.com/npm/
    ```

3. Install the package

    ```
    npm install --save @phoenix/node-eureka
    ```

4. Import and use in your project

    ```javascript
    // somewhere... in your project - eg. dist.js
    import startEurekaClient from 'node-eureka';

    // The function will return an instance of the eureka client
    let eurekaClient = startEurekaClient({
        ip: "172.25.1.189",
        port: options.port, // simpler to take the port from the options object that is made available to you
        name: "webstore",
        infoRoute: "/info",
        listeners: {
            started: function() {},
            registered: function() {}
        },
        servicePath: "/eureka/apps", // optional, this is the default value
        eurekaXML: "https://dev.ird.mu-sigma.com/eureka/apps" // optional, this is the default value
    });
    ```

5. Once the code runs, you'll a message on your terminal that the client has been registered; head over to the [Phoenix Eureka Dashboard](https://qa.ird.mu-sigma.com/dashboard)
    - You should be able to see your application in the dashboard against the name that you used to register it with


## Advanced Usage

* The options object take two more attributes - `eureka` & `instance`. Please look at the [eureka-js-client](https://www.npmjs.com/package/eureka-js-client) docs to understand what can be done with these two objects
