/**
 * Shapes
 * Ellipse
 * Project: Phoenix UI creator
 * Author: Debashish
 */


"use strict";

module.exports = {
    name: "ellipse",
    imports: [],
    variables: [{
        name: "alias",
        type: "string",
        defaultValue: "Ellipse",
        metadata: [{
            displayName: "Alias",
            widget: "INPUT",
            widgetData: {},
            grouping: "General",
            target: "alias"
        }],
        isMandatory: false,
        scope: "public"

    },
        {
            name: "compStyle",
            type: "object",
            defaultValue: {
                __root: {
                    "height": 100,
                    "width": 200,
                    "stroke": "rgba(0,0,0,1)",
                    "strokeWidth": 1,
                    "strokeDasharray": 0
                }
            },
            metadata: [{
                displayName: 'Ellipse',
                widget: 'SHAPE_PROPERTIES',
                widgetData: {
                    hyperlinkTarget: 'hyperlink'
                },
                grouping: '',
                tab: 'Style',
                target: 'compStyle.__root'
            },{
                displayName: "Background Color",
                widget: "COLOR_PICKER",
                widgetData: {},
                grouping: "General",
                target: "compStyle.__root.backgroundColor"
            }, {
                displayName: "Width",
                widget: "NUMERIC_STEPPER",
                widgetData: {},
                grouping: "General",
                target: "compStyle.__root.width"
            }, {
                displayName: "Height",
                widget: "NUMERIC_STEPPER",
                widgetData: {},
                grouping: "General",
                target: "compStyle.__root.height"
            }, {
                displayName: "Stroke",
                widget: "COLOR_PICKER",
                widgetData: {},
                grouping: "General",
                target: "compStyle.__root.stroke"
            }, {
                displayName: "Stroke-Width",
                widget: "NUMERIC_STEPPER",
                widgetData: {
                    minValue: 0
                },
                grouping: "General",
                target: "compStyle.__root.strokeWidth"
            }],
            scope: "public"
        },
        {
            name: "fillOpacity",
            type: "number",
            defaultValue: 1,
            metadata: [{
                displayName: "Fill-Opacity",
                widget: "SLIDER",
                widgetData: {
                    maxValue: 1,
                    minValue: 0,
                    stepCount: 0.1
                },
                grouping: "General",
                target: "fillOpacity"
            }],
            scope: "public"
        },
        {
            name: "strokeOpacity",
            type: "number",
            defaultValue: 1,
            metadata: [{
                displayName: "Stroke-Opacity",
                widget: "SLIDER",
                widgetData: {
                    maxValue: 1,
                    minValue: 0,
                    stepCount: 0.1
                },
                grouping: "General",
                target: "strokeOpacity"
            }],
            scope: "public"
        },
        {
            name: "colorTheme",
            type: "object",
            defaultValue: {
                scheme: "Default",
                colors: ""
            },
            scope: "public"
        },
        {
            name: "colorThemeDefault",
            type: "string",
            defaultValue: "#ffffff",
            scope: "public"
        },
        {
            name: "navigateFn",
            type: "function",
            defaultValue: () => {},
            scope: "public"
        },
        {
            name: "hyperlink",
            type: "object",
            defaultValue: null,
            metadata: [{
                displayName: "Hyperlink",
                widget: "HYPERLINK",
                widgetData: {},
                grouping: "Hyperlink",
                target: "hyperlink"
            }],
            scope: "public"
        },
        {
          name: 'isGradientFill',
          scope: 'public',
          type: 'boolean',
          defaultValue: false
        },
        {
          name: 'gradient',
          scope: 'public',
          type: 'object',
          defaultValue: {}
        }
    ],
    functions: {
        redirect: (e) => {
            __var__navigateFn(__var__hyperlink);
            e.preventDefault();
        },
        getGradient: (el) => {

          if(__var__isGradientFill) {
            var gradient = __var__gradient;
            if(gradient["id"].includes("linear")) {
              return __tmpl__linearGradient
            } else if(gradient["id"].includes("radial")) {
              return __tmpl__radialGradient
            }
          } else {
            return null
          }
        }
    },
    eventHandlers: [],
    eventEmitters: [],
    actions: [],
    workflows: {},
    localTemplates: {
      linearGradient: {
        type: 'linearGradient',
        id: "__fnParam__gradient.id",
        props: {
          id: "__fnParam__gradient.id",
          x1: "__fnParam__gradient.x1",
          x2: "__fnParam__gradient.x2",
          y1: "__fnParam__gradient.y1",
          y2: "__fnParam__gradient.y2",
        },
        children: ['__fnParam__gradient.stops.map(stop => __tmpl__stop)']
      },
      radialGradient: {
        type: 'radialGradient',
        id: "__fnParam__gradient.id",
        props: {
          cx: "__fnParam__gradient.id",
          cy: "__fnParam__gradient.x1",
          r: "__fnParam__gradient.x2"
        },
        children: ['__fnParam__gradient.stops.map(stop => __tmpl__stop)']
      },
      stop: {
        type: 'stop',
        props: {
          stopColor: '__fnParam__stop.stopColor',
          stopOpacity: '__fnParam__stop.stopOpacity || undefined',
          offset: '__fnParam__stop.offset',
        }
      },
      emptyDiv: {
        type: "div",
        props: {
          style: {
            display: "none",
            "data-info": "dummydiv for gradient in shape_rect"
          }
        }
      }
    },
    structure: {
        type: 'a',
        props: {

            href: "__var__hyperlink ? (__var__hyperlink.name + '.html') : '#'",
            onClick: "__fn__redirect"
        },
        children: {

            type: "svg",
            props: {
                viewBox: "'0 0 '+__var__compStyle.__root.width+ ' '+__var__compStyle.__root.height",
                width: "__var__compStyle.__root.width",
                height: "__var__compStyle.__root.height",
                style: {
                    overflow: "initial"
                },
            },
            children: [{
                type: "ellipse",
                props: {
                    rx: "(parseInt(__var__compStyle.__root.width) - parseInt(__var__compStyle.__root.strokeWidth)) / 2",
                    ry: "(parseInt(__var__compStyle.__root.height) - parseInt(__var__compStyle.__root.strokeWidth)) / 2",
                    cx: "__var__compStyle.__root.width / 2",
                    cy: "__var__compStyle.__root.height / 2",
                    style: {
                        fill: "__var__compStyle.__root.backgroundColor || (__var__colorTheme.colors? __var__colorTheme.colors[0]: __var__colorThemeDefault)",
                        fillOpacity: "__var__fillOpacity",
                        stroke: "__var__compStyle.__root.stroke",
                        strokeWidth: "__var__compStyle.__root.strokeWidth",
                        strokeOpacity: "__var__strokeOpacity",
                        strokeDasharray: "__var__compStyle.__root.strokeDasharray",
                        opacity:"__var__compStyle.__root.opacity"
                    }
                }

            },  "__fn__getGradient()"]
        }
    },
    lifecycleHooks: {}
};
